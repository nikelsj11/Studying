#TITLE:Рассказ о том, как подружить Nexus Player (FUGU) и Intel Mobile Development Kit

      Intel Mobile Development Kit для Android содержит множество полезных средств для разработки и оптимизации приложений. Для того чтобы в полной мере воспользоваться ими, создавая программы для Nexus Player, нужно внести некоторые изменения в прошивку устройства.
Существуют различные рабочие окружения и инструменты для Android-разработки. К тому же, они постоянно развиваются. Поэтому мы постарались сделать это руководство универсальным. Здесь приведены рекомендации и ссылки на необходимые ресурсы, которые позволят всем желающим подготовить Nexus Player к работе с Intel MDK. Мы проводили испытания, пользуясь следующими устройствами и программами:Целевое устройство Nexus Player (FUGU), купленное в свободной продаже, на котором установлен Android 5.1.0 (образ системы LMY47D).
Главный компьютер, подключённый к Internet, работающий под управлением Ubuntu 12.

Нужно отметить, что заводской образ системы LMY47D должен без проблем прошиваться на любой Nexus Player, который можно взять в магазине. Ниже мы рассмотрим ситуацию, в которой данная возможность может вам понадобиться.Сборка загрузочного образа с root-правами
Для того чтобы воспользоваться всеми возможностями Intel Mobile Development Kit (Intel MDK) на Nexus Player, необходимо иметь root-доступ к нему. Получить доступ можно, самостоятельно собрав образ boot.img и прошив его на устройство. Хотя в ходе подготовки boot.img создаются так же образы system.img и recovery.img, они нас не интересуют, так как для того, чтобы подготовить Nexus Player к работе с MDK, достаточно поработать над boot.img.
Найти инструкции по настройке окружения для сборки образа, а так же – по загрузке его исходного кода, вы можете, воспользовавшись ресурсом source.android.com.
Следуя руководству, приведенному на вышеупомянутом ресурсе, мы нашли самую свежую ветку кода, переключились на неё и выполнили сборку. На момент написания данного материала это была ветка LMY47D, или android-5.1.0_r1 для устройства FUGU. Как только будет подготовлена рабочая среда, для сборки образа нам понадобится следующая последовательность команд:repo init -u https://android.googlesource.com/platform/manifest -b android-5.1.0_r1
repo sync -j5
source build/envsetup.sh
lunch full_fugu-userdebug
make -j8
Обратите внимание на то, что команду lunch можно запустить и без параметров, тогда настройка выполняется через меню. Это может понадобиться для более поздних версий ядра, весьма вероятно то, что ключи запуска lunch могут измениться. Самое важное при запуске этой команды заключается, во первых – в том, сборка осуществляется для устройства FUGU, а во-вторых – в использовании параметра USERDEBUG.
Если всё сделано верно, то на данном этапе будут созданы несколько файлов, расположенных в папке out/target/product/fugu/. Среди них есть и тот, что нам нужен – boot.img.Получение root-прав на Nexus Player
Теперь, когда сборка загрузочного образа завершена, его надо прошить на устройство. Подключим Nexus Player к компьютеру с помощью USB и включим его. Убедимся, с помощью команды adb devices, что система его распознала. Если после выполнения этой команды окажется, что ADB не видит Nexus Player, обычно это означает, что в настройках разработчика на устройстве отключена возможность отладки по USB. Для продолжения работы её надо включить.
Теперь нам осталось выполнить довольно простую последовательность команд – и только что созданный образ будет прошит на устройство.adb reboot bootloader
fastboot oem unlock
fastboot flash boot out/target/product/fugu/boot.img
fastboot oem lock
fastboot continueNexus Player к работе готов!
Сейчас всё готово к работе с Nexus Player с помощью инструментов Intel Mobile Development Kit. В частности, после успешного завершения вышеописанных действий, вы сможете:Использовать Nexus Player по его прямому назначению.
Подключаться к устройству с помощью ADB и использовать команду adb root для работы в root-режиме.
Пользоваться Intel VTune Analyzer с Energy Profiler. Вот несколько полезных ссылок:
– Начало работы с Intel VTune Amplifier for Systems.
– Дополнительные подробности о том, как анализировать энергопотребление Nexus Player с помощью Intel SoCWatch и Energy Profiler можно найти в материале How to enable SoCWatch on Nexus (FUGU) player.
– Общие сведения об использовании Intel Energy Profiler можно найти в материале Начало работы с Intel Energy Profiler для Android.
Если что-то пошло не так…
Если в ходе работы что-то пошло не так, или вы, после экспериментов, хотите вернуть устройство к заводскому состоянию, в котором root-права не предоставляются, вы можете это сделать. Заводские образы для Nexus Player находятся здесь. Тут же имеется простые и понятные инструкции по перепрошивке. На самом деле, в начале работы над этим материалом на нашем устройстве была установлена Android 5.0. Однако поведение системы нас не устроило, поэтому Nexus Player был обновлен до Android 5.1.0 с использованием заводского образа LM47D. После этого всё, что нам было нужно, заработало как по волшебству.Итоги
Если вы хотите оптимизировать ваши Android-приложения для Nexus Player, то сейчас у вас есть всё необходимое для того, чтобы раскрыть потенциал этого устройства с помощью Intel Mobile Development Kit.
      
    