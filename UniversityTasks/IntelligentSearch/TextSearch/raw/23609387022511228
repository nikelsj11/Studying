#TITLE:Виртуализация приложений и десктопов: новый взгляд на старые проблемы

      Как известно, в условиях постигшего нас экономического кризиса выживают не сильнейшие, а наиболее приспособленные, к тому же поставщики охотнее идут на уступки, а клиенты ищут (и чаще всего успешно находят) различные варианты экономии. Область виртуализации приложений и десктопов – не исключение, поэтому мы хотели бы прямо сейчас заново рассмотреть плюсы и минусы ведущих решений в этой области.Citrix XenDesktop
Решение Citrix XenDesktop — наследник многолетнего лидера виртуализации приложений — продукта XenApp. С одной стороны, в новой версии Citrix XenDesktop\XenApp 7.6 появилась другая архитектура — даже лучше, чем у XenApp 6.5, за счет встроенной системы тиражирования образов виртуальных десктопов рабочих станций и серверов Machine Creation Services (в добавок к существовавшей ранее Provisioning Services — доставка образов по сети для виртуальных и физических серверов). С другой стороны, часть возможностей старой платформы XenApp 6.5 теперь недоступна. Например, перегрузка терминальных серверов по расписанию и публикация контента. Публикация приложений стала не такой гибкой, как была в 6.5. На данный момент компания прилагает много усилий для устранения этих пробелов, в частности в версии 7.6 вернули session pre-launch и session lingering. В пакете Feature Pack 1 вернулся Session Recording (a.k.a. Smart Auditor), однако в нем по-прежнему нет функции записи VDI-сессий (только терминальные сессии серверов).
Кроме того, решение Citrix расширяется с помощью дополнительных продуктов, позволяющих получить расширение функциональности за отдельную плату. Это NetScaler (балансировка нагрузки, application firewall, web acceleration, secure access) и CloudBridge – WAN-оптимизация (сжатие трафика, эффективное использование полосы пропускания).VMWare Horizon
Решение VMWare Horizon — изначально VDI-решение, и основные преимущества достигаются за счёт полной интеграции с гипервизором. Поэтому, чтобы получить все преимущества VMWare Horizon 6.2, необходимо установить vSphere 6.0 и соответствующие обновления. В области публикации приложений с терминальной фермы компания прилагает много усилий для сокращения отставания от Citrix. Например, в версии 6.0 появилась публикация приложений, в версии 6.1 — перенаправление USB-устройств хранения, а в версии 6.2 — перенаправление дисков клиентского устройства в сессию и умная балансировка нагрузки (требующая, однако,  ручной настройки скриптов на каждом терминальном сервере фермы).
В то же время VMWare Horizon включает в себя  VMware vSphere Desktop and vCenter Desktop , что используется только для VDI-решений (то есть для серверной виртуализации дополнительных трат не избежать). К тому же, если у вас уже есть гипервизор, вам придётся или мигрировать с него или внедрять рядом второй, что требует дополнительных инвестиций в персонал и двойных издержек на управление.
Оба решения имеют три редакции:VMWare Horizon — Standard, Advanced, Enterprise.
Citrix XenDesktop — VDI, Enterprise, Platinum.

И разные модели лицензирования:VMWare Horizon – named user, CCU 
Named user – учитывается уникальный пользователь, подключающийся к инфраструктуре View. Пользователь имеет право запускать любое количество десктопов VDI, RDS или приложений с любого количества устройств.
Concurrent user – учитывается количество подключений к однопользовательскому десктопу. Если конкурентный пользователь запускает несколько однопользовательских десктопов одновременно, то сессия к каждому десктопу учитывается отдельно. При этом конкурентный пользователь имеет право запускать любое количество десктопов RDS или приложений с одной лицензией с любого количества устройств.
Citrix XenDesktop – per user/device, CCU
Per user/device – это тип конвертируемой лицензии. Лицензия по умолчанию привязывается к пользователю на 90 дней и после этого пользователь имеет право запускать любое количество десктопов VDI, RDS или приложений с любого количества устройств. Если же несколько пользователей запускают сессии с одного и того же устройства, то несколько лицензий per user, превращаются в одну лицензию на устройство, а остаток за вычетом одной возвращается в пул.
Concurrent user – учитывается пользователь, подключающийся с любого устройства к любому количеству десктопов VDI, RDS или приложений, при этом лицензия высвобождается и возвращается в пул как только все сессии завершены или перешли в состояние disconnected.

А также разные модели апгрейда редакций и продуктов, подробнее смотрите соответственно:VMWare Horizon — VMware Horizon View Pricing Licensing FAQ 
Citrix XenDesktop — XenDesktop and XenApp Licensing FAQ 
Трудности выбора
Множество редакций и моделей лицензирования затрудняют и без того сложный выбор поставщика. Тем более, что не всегда требуются все функции той или иной редакции. Часто из-за одной функции приходится выбирать более дорогую редакцию. При этом матрицы сравнений функциональности производители часто пишут таким образом, что не сразу ясно, когда компонент включён в стоимость, а когда требуется доплата. Например,  в этой матрице у Citrix указано для Smart Access и SSL VPN, что NetScaler Gateway appliance оплачивается отдельно. А для NetScaler load-balancing (optional) и Integration with NetScaler HDX Insight такой информации уже нет. А о том, что HDX Framehawk Technology требует  определённой версии NetScaler для работы извне, написано только в его руководстве по внедрению.
Поэтому, как правило, реализовать и использовать на 100% все возможности решения не получается. К тому же, чем больше функциональности, тем сложнее внедрение, требующее более квалифицированного персонала. Часть клиентов просто не может внедрить самостоятельно такие сложные решения, а приглашать консалтинг либо не позволяет бюджет, либо нет желания тратить деньги ещё и на этот пункт. Отсюда — неудовлетворённость решением и потерянные инвестиции.Parallels Remote Application Server
А что может  Parallels RAS? Прежде всего, это комплексное решение, расширяющее возможности Microsoft RDS&amp;VDI и поддерживающее основные гипервизоры — Microsoft Hyper-V, VMWare vSphere и Citrix XenServer. Это простое развёртывание, где компоненты решения устанавливаются удалённо прямо из консоли управления.
Во-вторых, есть возможность публиковать приложения и десктопы с одного терминального сервера, тогда как на Windows 2012R2 для этого потребуется две session collection (два сервера минимум). Удобно публиковать приложения, используя Drag&amp;Drop или мастер публикации, позволяющий публиковать не только приложения и десктопы в бесшовном режиме, но и контент. Parallels RAS  объединяет ресурсы в одну логическую единицу – ферму, имеющую единый сервер лицензий. Если ресурсы территориально распределены, то ферма позволяет использовать сайты, для которых можно делегировать управление. В дополнение к балансировке Microsoft RDS (вес хоста и количество сессий) используется продвинутая балансировка нагрузки (ЦПУ, память, количество сессий), а также функции универсальной печати и сканирования, работающие из коробки (TWAIN на Windows 2012R2 требует дополнительной настройки). 
В решение встроена высокая доступность – если первый сервер в сайте, являющийся мастером, по какой-то причине выходит из строя, следующий сервер принимает на себя его функции (балансировка и перечисление приложений).
В решение Parallels Remote Application Server также входят программный шлюз безопасности Secure Client Gateway, позволяющий туннелировать RDP трафик в SSL, и виртуальное устройство HALB (High Availability and Load Balancing), позволяющее балансировать нагрузку между шлюзами безопасности Secure Client Gateway (работает в двух режимах – pass-though и SSL offload).
Доступ к опубликованным ресурсам может предоставляться без клиентского ПО через совместимый с HTML5 браузер.
Функция Client Device Management позволяет превратить клиентское устройство на базе Windows ОС в тонкого клиента, а также осуществлять удалённое управление рабочей станцией пользователя, используя собственное решение Shadowing.
Плюс интерфейс, поддерживающий 11 языков, собственных клиентов для Windows, Linux, Mac, Chromebook, iOS, Android, Windows Phone и Raspberry Pi, аудит действий администратора (settings auditing), функции мониторинга и отчётов.
У этой единой и стандартной версии есть гибкие схемы лицензирования:SPLA — конкурентная лицензия на пользователя и одно его устройство для запуска неограниченного количества приложений и десктопов (если два устройства у пользователя, то потребуется две лицензии для одновременного их использования), с ограниченной по сроку действия подпиской на 1, 3, 6 или 12 месяцев. Предназначена для провайдеров услуг с авансовой схемой платежей.
Perpetual CCU – бессрочная конкурентная лицензия на пользователя и одно его устройство для запуска неограниченного количества приложений и десктопов (если пользователь одновременно использует два устройства, то потребуется две лицензии). Возможность апгрейда на следующую версию включена на 1 год при покупке, поддержка приобретается отдельно.
Вывод:
Как при покупке автомобиля не стоит гнаться за лошадиными силами и полным приводом, если ездить придётся в основном в густонаселённом городе с тяжёлым трафиком. Так и при выборе решения не стоит гнаться за количеством функций, если вы не собираетесь их использовать. Оцените влияние бренда на стоимость и качество продукта. Ставьте и изучайте функции, чтобы понять, подходит ли конкретное решение под ваши нужды. И хотя нам, в принципе, есть что сказать и по поводу стоимости решений, мы считаем, что сравнивать цены нужно уже только после этого.И помните, кризис — это время перемен и новые возможности.
Каким решением виртуализации вы пользуетесь и почему? В комментариях готовы ответить на все ваши вопросы.

      
      
    